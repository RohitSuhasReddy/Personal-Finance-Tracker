/* test_main.c */
#include <stdio.h>
#include "Finance.h"
#include "transactions.h"
#include "limits.h"
#include "reports.h"

int main() {
    printf("=== PROJECT DATA SIMULATION ===\n\n");

    // --- STEP 1: DEFINE BUDGETS ---
    // We set a limit of $100 for Food.
    setBudget("Food", 100.00); 
    printf("[SETUP] Budget for 'Food' set to $100.00\n");

    // --- STEP 2: CREATE DATES ---
    Date d1 = {1, 11, 2023};
    Date d2 = {5, 11, 2023};
    Date d3 = {10, 11, 2023};
    Date d4 = {15, 11, 2023}; // Mid-month
    Date d5 = {20, 11, 2023};

    // --- STEP 3: BATCH ADD TRANSACTIONS ---
    
    // 1. Income (Salary)
    Transaction t1 = {1, 5000.00, "INCOME", "Salary", "Nov Salary", d1};
    addTransaction(t1);

    // 2. Expense (Rent)
    Transaction t2 = {2, 1200.00, "EXPENSE", "Rent", "House Rent", d2};
    addTransaction(t2);

    // 3. Expense (Food - Under Budget)
    Transaction t3 = {3, 50.00, "EXPENSE", "Food", "Groceries", d3};
    // Check budget before adding
    if (isOverBudget("Food", getCategoryTotal("Food") + t3.amount)) {
        printf("[ALERT] Warning! Over Budget on Food.\n");
    }
    addTransaction(t3);

    // 4. Expense (Food - BREAKING Budget)
    // Current Food spend is 50. Limit is 100. New spend is 150. Total will be 200.
    Transaction t4 = {4, 150.00, "EXPENSE", "Food", "Fancy Dinner", d4};
    
    printf("\n--- Testing Budget Logic for Transaction #4 ---\n");
    if (isOverBudget("Food", getCategoryTotal("Food") + t4.amount)) {
        printf("[SUCCESS] Budget Alert Triggered for 'Fancy Dinner'!\n");
    } else {
        printf("[FAIL] Budget Alert missed.\n");
    }
    addTransaction(t4);

    // 5. Income (Freelance)
    Transaction t5 = {5, 300.00, "INCOME", "Freelance", "Design Work", d5};
    addTransaction(t5);

    // --- STEP 4: PRINT REPORT ---
    printf("\n=== FINAL REPORT ===\n");
    printf("Total Income:   %.2f (Expected: 5300.00)\n", getTotalIncome());
    printf("Total Expense:  %.2f (Expected: 1400.00)\n", getTotalExpense());
    printf("Current Balance: %.2f (Expected: 3900.00)\n", getCurrentBalance());
    
    printf("Total Spent on Food: %.2f (Expected: 200.00)\n", getCategoryTotal("Food"));

    return 0;
}